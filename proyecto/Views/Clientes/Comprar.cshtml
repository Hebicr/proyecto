@model proyecto.Models.RegistrosPolizas

@{
    ViewBag.Title = "Comprar";
}

<body background="\img\Prueba.png" style="width:100%; height:100%; background-size: cover;">

    @using (Html.BeginForm())
    {
        @Html.AntiForgeryToken()

        <div class="container justify-content-center" style="height: 670px; width: 350px; background-color: white; padding-top: 50px; border-radius: 10px 10px ">
            <div class="form-horizontal">
                <div class="text-center">
                    <h4>Compra Polizas</h4>
                </div>
                <br />
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                @Html.Hidden("idCliente", "idCliente", new { htmlAttributes = new { @class = "form-control", @required = "required", @Value = @TempData["idCliente"], @hidden = "hidden" } })

                <div class="form-group">
                    <div class="col-md-10">
                        Cobertura:
                        @Html.DropDownListFor(model => model.idCoberturaPoliza, ViewBag.coberturas as SelectList, "-- Seleccione una Cobertura --", new { @class = "form-control", @required = "required" })
                        @Html.ValidationMessageFor(model => model.idCoberturaPoliza, "", new { @class = "text-danger" })
                    </div>
                </div>
                @Html.Hidden("Porcentaje", new { htmlAttributes = new { @class = "form-control", @required = "required", @readonly = "readonly" } })
                <div class="form-group">


                    <div class="col-md-10">
                        Monto Asegurado:
                        @Html.EditorFor(model => model.montoAsegurado, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.montoAsegurado, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-10">
                        Número adiciones:
                        @Html.EditorFor(model => model.numeroAdiciones, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.numeroAdiciones, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-10">
                        Monto adicciones:
                        @Html.EditorFor(model => model.montoAdiciones, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.montoAdiciones, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-10">
                        Prima Antes:
                        @Html.EditorFor(model => model.primaAntesImpuestos, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.primaAntesImpuestos, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-10">
                        Impuestos:
                        @Html.EditorFor(model => model.impuestos, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.impuestos, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-10">
                        Prima final:
                        @Html.EditorFor(model => model.primaFinal, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.primaFinal, "", new { @class = "text-danger" })
                    </div>
                </div>
                <br />
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">
                        <input type="submit" style="float:right" value="Comprar" class="btn btn-primary" />
                    </div>
                </div>
            </div>
            </div>
            }

    </body>

    @section Scripts{
        <script>
            $(document).ready(function () {
                $("#idCoberturaPoliza").change(function () {
                    $.get("/Clientes/RetornaPorcentaje?",
                        { idCoberturaPoliza: $("#idCoberturaPoliza").val() },
                        function (data) {
                            $("#Porcentaje").empty();
                            $.each(data, function (index, row) {
                                $("#Porcentaje").val(row.Porcentaje);
                            });
                        }
                    )
                });
            });
        </script>
    }
